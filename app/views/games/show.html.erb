<%= turbo_stream_from @game %>
<%= turbo_stream_from current_user %>

<div data-controller="answer" data-answer-participation-id-value="<%= current_user.find_participation(@game).id %>">
  <div class="container" id="game">
    <% unless @game.started? || @game.ended? %>
      <div id="players">
        <div id='bouncing-text'>
          <p id='bounceTxt'>Waiting players . . .</p>
        </div>

        <%= render "games/players", players: @game.players, game: @game, user: current_user %>
      </div>
    <% end %>

    <div id="question">
      <% if @game.started? %>
        <%= render "games/question", question: @game.current_question %>
      <% end %>
    </div>

    <div id="answer">
      <% if @game.started? %>

      <% end %>
    </div>

    <div id="scores">
      <% if @game.started? %>
        <%= render "games/scores", participations: @game.participations, looser: false %>
      <% end %>
    </div>

    <div id="summary">
      <% if @game.ended? %>
        <%= render "games/summary", participations: @game.participations, looser: false %>
      <% end %>
    </div>
    </div>
  </div>

  </div>
</div>

<script>
  var myText = document.getElementById("bounceTxt").innerHTML,
     wrapText = "";

  for (var i = 0; i < myText.length; i++) {
      wrapText += "<em>" + myText.charAt(i) + "</em>";
  }

  document.getElementById("bounceTxt").innerHTML = wrapText;

  var myLetters = document.getElementsByTagName("em"),
      j = 0;

  function applyBounce() {
      setTimeout(function () {
            myLetters[j].className = "bounce-me";
            j++;

            if (j < myLetters.length) {
                applyBounce();
            }
      }, 250);
  }

  applyBounce();
</script>
